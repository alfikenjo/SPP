@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@using Frontend_SPP.Resources.Home

@{
    ViewData["Title"] = "My Profile";
    Layout = "~/Views/Shared/_Layout_FO.cshtml";
}

@section scripts{

    <script src="@Url.Content("~/script/MyProfile.js")"></script>
}

<style>
    .ClearFile {
        display: none;
    }

    #message {
        display: none;
        /*background: #f1f1f1;*/
        color: #000;
        position: relative;
        padding: 20px;
        margin-top: 10px;
    }

        #message p {
            padding: 0 35px 0 35px;
            font-size: 14px;
        }

    /* Add a green text color and a checkmark when the requirements are right */
    .valid {
        color: green;
    }

        .valid:before {
            position: relative;
            left: -35px;
            content: "✔";
        }

    /* Add a red text color and an "x" icon when the requirements are wrong */
    .invalid {
        color: red;
    }

        .invalid:before {
            position: relative;
            left: -35px;
            content: "✖";
        }
</style>

<input type="hidden" name="UserID" id="UserID" />
<input type="hidden" name="culture" id="culture" value=@HttpContextAccessor.HttpContext.Session.GetString("culture").ToLower() />
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body p-0">
                <div class="iq-edit-list usr-edit">
                    <ul class="iq-edit-profile d-flex nav nav-pills">
                        <li class="col-md-4 p-0">
                            <a class="nav-link active" data-toggle="pill" href="#personal-information">
                                Personal Information
                            </a>
                        </li>
                        <li class="col-md-4 p-0">
                            <a class="nav-link" data-toggle="pill" href="#chang-pwd">
                                Change Password
                            </a>
                        </li>
                        <li class="col-md-4 p-0">
                            <a class="nav-link" data-toggle="pill" href="#emailandsms">
                                Account
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-12">
        <div class="iq-edit-list-data">
            <div class="tab-content">
                <div class="tab-pane fade active show" id="personal-information" role="tabpanel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <div class="iq-header-title">
                                <h4 class="card-title">Personal Information</h4>
                            </div>
                        </div>
                        <div class="card-body">
                            <form id="FormInput" name="FormInput">
                                <div class="form-group row align-items-center">
                                    <div class="col-md-12">
                                        <div class="profile-img-edit">
                                            <div class="crm-profile-img-edit">
                                                <img id="imgempPicture" class="crm-profile-pic rounded-circle avatar-100" src="@HttpContextAccessor.HttpContext.Session.GetString("img")" alt="profile-pic" />
                                                <div class="crm-p-image bg-primary">
                                                    <i class="las la-pen upload-button"></i>
                                                    <input type="file" id="fuempPicture" name="fuempPicture" class="file-upload" />
                                                </div>
                                            </div>
                                            <div class="crm-p-image bg-danger" style="left: 20px !important; top: 75px !important; font-size: 13px;line-height: 26px;">
                                                <i class="las la-trash" onclick="ClearFile('fuempPicture');"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class=" row align-items-center">
                                    <div class="form-group col-sm-6">
                                        <label>Nama Lengkap</label>
                                        <label class="ENLabel">Fullname</label>
                                        <input type="text" id="txtFullname" name="txtFullname" class="form-control" maxlength="100" />
                                    </div>
                                    <div class="form-group col-sm-6">
                                        <label>Jenis Kelamin</label>
                                        <label class="ENLabel">Gender</label>
                                        <select id="ddlGender" class="form-control">
                                            <option value="" selected>- Select -</option>
                                            <option value="M">Male</option>
                                            <option value="F">Female</option>
                                        </select>
                                    </div>

                                    <div class="form-group col-sm-12">
                                        <label>Role(s)</label>
                                        <div id="div_Role"></div>
                                    </div>

                                    <div class="form-group col-sm-12">
                                        <label>Alamat</label>
                                        <label class="ENLabel">Address</label>
                                        <textarea style="text-align: justify" id="txtAddress" name="txtAddress" class="form-control" maxlength="250" height="75px"></textarea>
                                    </div>
                                </div>
                                <button id="btn_UpdateProfil" type="submit" form="FormInput" class="btn btn-sm btn-primary"><i class="fa fa-spinner fa-spin button-spinner"></i><i class="fa fa-save"></i>&nbsp;Update Profile</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="chang-pwd" role="tabpanel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <div class="iq-header-title">
                                <h4 class="card-title">Change Password</h4>
                            </div>
                        </div>
                        <div class="card-body">
                            <form id="FormChangePassword" name="FormChangePassword">
                                <div class="form-group">
                                    <label>Current Password:</label>
                                    <input type="password" id="CurrentPassword" name="CurrentPassword" class="form-control" />
                                </div>
                                <div class="form-group">
                                    <label>New Password:</label>
                                    <input type="password" id="NewPassword" name="NewPassword" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" class="form-control" />
                                </div>
                                <div class="form-group">
                                    <label>Verify Password:</label>
                                    <input type="password" id="NewPasswordVerifiy" name="NewPasswordVerifiy" class="form-control" />
                                </div>

                                <div id="message" class="form-group">
                                    <h3>Password must contain the following:</h3>
                                    <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
                                    <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
                                    <p id="number" class="invalid">A <b>number</b></p>
                                    <p id="length" class="invalid">Minimum <b>8 characters</b></p>
                                </div>

                                <button id="btn_ChangePassword" type="submit" form="FormChangePassword" class="btn btn-sm btn-primary"><i class="fa fa-spinner fa-spin button-spinner"></i><i class="fa fa-save"></i>&nbsp;Change Password</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="emailandsms" role="tabpanel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <div class="iq-header-title">
                                <h4 class="card-title">Account</h4>
                            </div>
                        </div>
                        <div class="card-body">
                            <form id="FormUpdateEmail" name="FormUpdateEmail">
                                <div class="col-md-6 col-sm-12">
                                    <div class="form-group">
                                        <label>Email Address *)</label>
                                        <input type="email" id="txtEmail" name="txtEmail" readonly="readonly" class="form-control" maxlength="200" />
                                    </div>

                                    <div class="form-group">
                                        <label>Nomor Handphone</label>
                                        <label class="ENLabel">Phone Number</label>
                                        <input type="tel" id="txtMobile" name="txtMobile" maxlength="15" oninput="this.value = this.value.replace(/[^0-9]/g, '').replace(/(\..*?)\..*/g, '$1').replace(/^0[^]/, '0');" value="" class="form-control phone" />
                                    </div>

                                </div>
                                <div class="col-md-6 col-sm-12 row">
                                    <button id="btn_UpdateEmail" type="submit" form="FormUpdateEmail" class="btn btn-sm btn-primary ml-3 mr-2"><i class="fa fa-spinner fa-spin button-spinner"></i><i class="fa fa-save"></i>&nbsp;Update</button>
                                    <button id="btn_verifikasi_mobile" style="display: none" type="button" class="btn btn-sm btn-outline-danger" onclick="ResendOTP(); return false;"><i class="fa fa-spinner fa-spin button-spinner"></i>@R_Home.VerifikasiNomorHandphone</button>
                                </div>
                            </form>

                            <form id="FormSubmitOTP" name="FormSubmitOTP" style="display: none">
                                <div class="form-group">
                                    <label>Input OTP *)</label>
                                    <input type="text" id="OTP" name="OTP" maxlength="6" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" value="" class="form-control" />
                                </div>

                                <button type="submit" formaction="FormSubmitOTP" class="btn btn-primary"><i class="fa fa-spinner fa-spin button-spinner"></i>SUBMIT</button>
                                <button type="button" class="btn btn-outline-secondary" onclick="ShowUpdateAkunForm(); return false;">Cancel</button><br /><br />
                                <a style="cursor: pointer" onclick="ResendOTP()" class="float-end mt-2"><i class="fa fa-spinner fa-spin button-spinner"></i>Resend OTP</a>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>